<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="SQL - Hàm kết hợp, gom nhóm và truy vấn lồng"><meta name="keywords" content=""><meta name="author" content="Ta Minh Huy,undefined"><meta name="copyright" content="Ta Minh Huy"><title>SQL - Hàm kết hợp, gom nhóm và truy vấn lồng【Minh Huy Blog】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Success',
    error: 'Error',
    noSupport: 'No Support'
  },
  gitment: {},
  valine: {},
}</script><meta name="generator" content="Hexo 6.2.0"></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="Post Folder">Overview</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">Catalog</div><div class="sidebar-toc-progress"><span class="progress-notice">Đã đọc</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Inner-Join"><span class="toc-number">1.</span> <span class="toc-text">Inner Join</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Full-Out-Join"><span class="toc-number">2.</span> <span class="toc-text">Full Out Join</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Left-Right-Join"><span class="toc-number">3.</span> <span class="toc-text">Left - Right Join</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Union"><span class="toc-number">4.</span> <span class="toc-text">Union</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SELECT-INTO"><span class="toc-number">5.</span> <span class="toc-text">SELECT INTO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSERT-INTO-SELECT"><span class="toc-number">6.</span> <span class="toc-text">INSERT INTO SELECT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Truy-van-long"><span class="toc-number">7.</span> <span class="toc-text">Truy vấn lồng</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">Ta Minh Huy</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/huytm2k3" target="_blank">GitHub<i class="icon-dot bg-color4"></i></a><a class="links-button button-hover" href="mailto:huyat180522@gmail.com" target="_blank">E-Mail<i class="icon-dot bg-color5"></i></a><a class="links-button button-hover" href="https://www.facebook.com/profile.php?id=100072417355186" target="_blank">Facebook<i class="icon-dot bg-color6"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">Post</span><span class="pull-bottom">64</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">Tags</span><span class="pull-bottom">42</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">Categories</span><span class="pull-bottom">5</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">Trang chủ</a><a class="menu-item" href="/tags">Thẻ</a><a class="menu-item" href="/categories">Danh mục</a><a class="menu-item" href="/archives">Mục lục</a><a class="menu-item" href="/about">Giới thiệu</a><a class="menu-item" href="/plan">Kế hoạch 2023</a><a class="menu-item" href="/sumary22">Tổng kết 2022</a><a class="menu-item" href="/book">Sách hay</a></nav><script src="/js/audio_autoplay.js"></script><div class="right-info"><audio controls="" autoplay="" id="bg-music" style="display: none"><source src="/audio/bgmusic.mp3" type="audio/mpeg"></audio><a class="title-name" href="/">Minh Huy Blog</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">SQL - Hàm kết hợp, gom nhóm và truy vấn lồng</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> Posted 2022-11-22 | Modified 2023-08-01</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"></div><div class="button-hover tags"></div></div></div><div class="main-content"><h2 id="Inner-Join"><a href="#Inner-Join" class="headerlink" title="Inner Join"></a>Inner Join</h2><p>Kết hợp 2 bảng, lấy ra trường thỏa mãn điều kiện.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Inner join kiểu cũ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> GIAOVIEN, BOMON</span><br><span class="line"><span class="keyword">WHERE</span> BOMON.MABM <span class="operator">=</span> GIAOVIEN.MABM</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Inner join kiểu mới</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> GIAOVIEN <span class="keyword">INNER</span> <span class="keyword">JOIN</span> BOMON</span><br><span class="line"><span class="keyword">ON</span> BOMON.MABM <span class="operator">=</span> GIAOVIEN.MABM</span><br></pre></td></tr></table></figure>

<h2 id="Full-Out-Join"><a href="#Full-Out-Join" class="headerlink" title="Full Out Join"></a>Full Out Join</h2><p>Phần này khó giải thích quá ạ &#x3D;))</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> GIAOVIEN <span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> BOMON</span><br><span class="line"><span class="keyword">ON</span> BOMON.MABM <span class="operator">=</span> GIAOVIEN.MABM</span><br></pre></td></tr></table></figure>

<h2 id="Left-Right-Join"><a href="#Left-Right-Join" class="headerlink" title="Left - Right Join"></a>Left - Right Join</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Left join</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> BOMON <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> GIAOVIEN</span><br><span class="line"><span class="keyword">ON</span> BOMON.MABM <span class="operator">=</span> GIAOVIEN.MABM</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Right join</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> BOMON <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> GIAOVIEN</span><br><span class="line"><span class="keyword">ON</span> BOMON.MABM <span class="operator">=</span> GIAOVIEN.MABM</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Với LEFT JOIN, các row trong table BOMON sẽ đi tìm các row của table GIAOVIEN thỏa mãn điều kiện để ghép nối với chúng (điều kiện ở đây là ON BOMON.MABM &#x3D; GIAOVIEN.MABM), với RIGHT JOIN thì ngược lại.</p>
<p>Một giáo viên, dạy một bộ môn thì chắc chắn kết quả sẽ không bao gồm null, vì chắc chắn tồn tại bộ môn đó, nên LEFT JOIN trong trường hợp này không bị NULL.</p>
<p>Một bộ môn, chưa chắc đã có giáo viên dạy, nên trường hợp này có thể bị null</p>
<h2 id="Union"><a href="#Union" class="headerlink" title="Union"></a>Union</h2><p>Gộp 2 bảng lại với nhau, lấy ra các row duy nhất chứ không bị lặp lại</p>
<h2 id="SELECT-INTO"><a href="#SELECT-INTO" class="headerlink" title="SELECT INTO"></a>SELECT INTO</h2><p>Sao chép dữ liệu ra một bảng chưa tạo</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- Lấy hết dữ liệu của bảng GIAOVIEN đưa vào bảng mới tên là TableA</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">INTO</span> TableA</span><br><span class="line"><span class="keyword">FROM</span> GIAOVIEN </span><br><span class="line"></span><br><span class="line"><span class="comment">-- Tạo ra bảng TableB mới có 1 trường HoTen, sao chép dữ liệu từ bảng GIAOVIEN</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> HoTen <span class="keyword">INTO</span> TableB</span><br><span class="line"><span class="keyword">FROM</span> GiAOVIEN</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Tạo ra bảng TableC mới có 1 trường HoTen, lấy dữ liệu từ bảng GIAOVIEN với những giáo viên có lương &gt; 2000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> HoTen <span class="keyword">INTO</span> TableB</span><br><span class="line"><span class="keyword">FROM</span> GIAOVIEN</span><br><span class="line"><span class="keyword">WHERE</span> LUONG <span class="operator">&gt;</span> <span class="number">2000</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="INSERT-INTO-SELECT"><a href="#INSERT-INTO-SELECT" class="headerlink" title="INSERT INTO SELECT"></a>INSERT INTO SELECT</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- Tạo ra một bảng CLoneGV có các trường giống GIAOVIEN nhưng không có dữ liệu</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">IN</span> CLoneGV</span><br><span class="line"><span class="keyword">FROM</span> GIAOVIEN</span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">1</span><span class="operator">=</span><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Sao chép dữ liệu </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> CloneGV</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> GIAOVIEN</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Truy-van-long"><a href="#Truy-van-long" class="headerlink" title="Truy vấn lồng"></a>Truy vấn lồng</h2><p>Nếu ta có 1 table như này:</p>
<p><img src="/images/SQLAdvPost/Screenshot_1.png"></p>
<p>Để kiểm tra GV001 có nằm trong danh sách GVQLCM hay không, chúng ta dùng truy vấn lồng. Nếu GV 001 nằm trong danh sách GVQLCM, in ra thông tin GV 001</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> GIAOVIEN</span><br><span class="line"><span class="keyword">WHERE</span> MAGV <span class="operator">=</span> <span class="string">&#x27;001&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> MAGV <span class="keyword">IN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> GVQLCM <span class="keyword">FROM</span> GIAOVIEN</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>Truy vấn lồng trong form</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span></span><br><span class="line">GIAOVIEN, (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> DETAI) <span class="keyword">AS</span> DT</span><br><span class="line"><span class="comment">-- ...</span></span><br></pre></td></tr></table></figure>


</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Ta Minh Huy</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://huytm2k3.github.io/2022/11/22/SQL-Ham-ket-hop-gom-nhom-va-truy-van-long/">https://huytm2k3.github.io/2022/11/22/SQL-Ham-ket-hop-gom-nhom-va-truy-van-long/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated. Reprint please indicate from <a href="https://huytm2k3.github.io">Minh Huy Blog</a>！</span></div></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2022/11/28/Ke-hoach-cuoi-2022/"><i class="fas fa-angle-left">&nbsp;</i><span>Kế hoạch cuối 2022 - Đầu 2023</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2022/11/22/SQL-Phan-tich-ERD-Luoc-do-quan-he/"><span>SQL - Phân tích ERD, Lược đồ quan hệ</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2022 ～ 2023 By Ta Minh Huy</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--></body></html>